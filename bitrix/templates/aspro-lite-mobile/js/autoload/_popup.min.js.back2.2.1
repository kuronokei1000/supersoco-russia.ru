appAspro.popup={},appAspro.popup.onLoadjqm=(name,hash,_this)=>{if(funcDefined("onlyCatalogMenuClose")&&onlyCatalogMenuClose(),(void 0===hash.c.noOverlay||void 0!==hash.c.noOverlay&&!hash.c.noOverlay)&&$("body").addClass("jqm-initied"),$("body").addClass("swipeignore")," undefined"!=typeof $(hash.t).data("ls")&&$(hash.t).data("ls")){var ls=$(hash.t).data("ls"),ls_timeout=0,v="";if($(hash.t).data("ls_timeout")&&(ls_timeout=$(hash.t).data("ls_timeout")),ls_timeout=ls_timeout?Date.now()+1e3*ls_timeout:"","undefined"!=typeof localStorage){var val=localStorage.getItem(ls);try{v=JSON.parse(val)}catch(e){v=val}null!=v&&localStorage.removeItem(ls),v={},v.VALUE="Y",v.TIMESTAMP=ls_timeout,localStorage.setItem(ls,JSON.stringify(v))}else{var val=$.cookie(ls);val||$.cookie(ls,"Y",{expires:ls_timeout})}var dopClasses=hash.w.find(".marketing-popup").data("classes");dopClasses&&hash.w.addClass(dopClasses)}if(hash.w.hasClass("auth_frame")&&hash.w.find(".form-group:not(.eye-password-ignore) [type=password]").each((function(item){let inputBlock=$(this).closest(".input");if(inputBlock.length)inputBlock.addClass("eye-password");else{let labelBlock=passBlock.find(".label_block"),passBlock=$(this).closest(".form-group");labelBlock.length?labelBlock.addClass("eye-password"):passBlock.addClass("eye-password")}})),$.each($(hash.t).get(0).attributes,(function(index,attr){if(/^data\-autoload\-(.+)$/.test(attr.nodeName)){var key=attr.nodeName.match(/^data\-autoload\-(.+)$/)[1],el=$('input[name="'+key.toUpperCase()+'"]');el.length||(el=$('input[data-sid="'+key.toUpperCase()+'"]'));var value=$(hash.t).data("autoload-"+key);value=value.toString().replace(/%99/g,"\\"),el.val(BX.util.htmlspecialcharsback(value)).attr("readonly","readonly"),el.closest(".form-group").addClass("input-filed"),el.attr("title",el.val())}})),hash.w.hasClass("send_gift_frame")){let imgHtml,priceHtml,propsHtml;imgHtml=priceHtml=propsHtml="",$('.detail-gallery-big link[itemprop="image"]').length&&(imgHtml='<img src="'+$('.detail-gallery-big link[itemprop="image"]').attr("href")+'" alt="" title="" />'),$(".catalog-detail__buy-block .price__new").length&&(priceHtml='<div class="item-block-info__price color_222">'+$(".catalog-detail__buy-block .price__new-val").text()+"</div>"),$(".catalog-block__offers .sku-props__item").length&&(propsHtml='<div class="item-block-info__props font_13">',$(".catalog-block__offers .sku-props__item").each((function(){propsHtml+='<div class="item-block-info__props-item">'+$(this).find(".sku-props__title").text()+"</div>"})),propsHtml+="</div>"),$('<div class="popup__item-block"><div class="popup__item-block-title">'+BX.message("POPUP_GIFT_TEXT")+'</div><div class="popup__item-block-info bordered rounded-x grid-list grid-list--gap-20"><div class="item-block-info__image grid-list__item">'+imgHtml+'</div><div class="item-block-info__text grid-list__item"><div class="name">'+$("h1").text()+"</div>"+priceHtml+propsHtml+"</div></div></div>").prependTo(hash.w.find(".form-body"))}if(void 0===hash.c.noOverlay||void 0!==hash.c.noOverlay&&!hash.c.noOverlay){let diffWidth;(diffWidth=window.innerWidth-document.documentElement.clientWidth)&&$("body").css({"padding-right":diffWidth+"px"}),$("body").css({overflow:"hidden",height:"100vh"}),hash.w.closest("#popup_iframe_wrapper").css({"z-index":3e3,display:"flex"})}var eventdata={action:"loadForm"};if(BX.onCustomEvent("onCompleteAction",[eventdata,$(hash.t)[0]]),$(hash.t).data("autohide")&&$(hash.w).data("autohide",$(hash.t).data("autohide")),$(hash.t).data("autoshow")&&eval($(hash.t).data("autoshow")),"order_product"==name&&$(hash.t).data("product")&&($('input[name="PRODUCT"]').closest(".form-group").addClass("input-filed"),$('input[name="PRODUCT"]').val($(hash.t).data("product")).attr("readonly","readonly").attr("title",$('input[name="PRODUCT"]').val())),"question"==name&&$(hash.t).data("product")&&($('input[name="NEED_PRODUCT"]').closest(".form-group").addClass("input-filed"),$('input[name="NEED_PRODUCT"]').val($(hash.t).data("product")).attr("readonly","readonly").attr("title",$('input[name="NEED_PRODUCT"]').val())),"ocb"===name){const parent=hash.w.find(".flexbox").first(),item=_this.closest(".js-popup-block");var data=item.find("[data-item]").data("item");void 0!==data&&data||(data={}),parent.addClass("flexbox--direction-row-reverse"),parent.find(".form.popup").addClass("flex-grow-1");let goodsNode='<div class="goods-popup"><div class="goods-popup__sticky">',imageNode='<div class="goods-popup__image image-list-wrapper">';item.find(".sticker").length&&(imageNode+='<div class="sticker sticker--upper">',imageNode+=item.find(".sticker").html(),imageNode+="</div>"),imageNode+='<div class="image">',imageNode+='<img class="img-responsive" src="'+(item.find(".image-list__link link[itemprop=image]").length?item.find(".image-list__link link[itemprop=image]:first").attr("href"):item.find(".image-list-wrapper img:first").length?item.find(".image-list-wrapper img:first").attr("src"):arAsproOptions.SITE_TEMPLATE_PATH+"/images/svg/noimage_product.svg")+'" />',imageNode+="</div>",imageNode+="</div>",goodsNode+=imageNode;let infoNode='<div class="goods-popup__info">';item.find(".js-popup-title").attr("href")?(infoNode+='<a class="dark_link switcher-title goods-popup__info-link font_15" href="'+item.find(".js-popup-title").attr("href")+'">',infoNode+=data?data.NAME:item.find(".js-popup-title").html(),infoNode+="</a>"):(infoNode+='<div class="color_222 switcher-title goods-popup__info-link font_15">',infoNode+=data?data.NAME:item.find(".js-popup-title").html(),infoNode+="</div>");let status="";item.find(".status-container").length&&(status+='<div class="line-block__item font_14">',status+=item.find(".status-container").wrap("<div></div>").parent().html(),status+="</div>");let article="";if(item.find(".js-popup-info .article").length&&(article+='<div class="line-block__item font_13 color_999">',article+=item.find(".js-popup-info .article").closest(".line-block__item").html(),article+="</div>"),(article||status)&&(infoNode+='<div class="line-block line-block--20 flexbox--wrap goods-popup__info-more">'+status+article+"</div>"),infoNode+="</div>",goodsNode+=infoNode,item.find(".js-popup-price .price").length){let priceNode='<div class="goods-popup__price">';priceNode+=item.find(".js-popup-price").html(),priceNode+="</div>",goodsNode+=priceNode;let $price=item.find(".js-popup-price .price__new-val");$price.length&&parent.find("input[name=PRODUCT_PRICE],input[data-sid=PRODUCT_PRICE]").val($price.text().trim())}goodsNode+="</div></div>",$(goodsNode).appendTo(parent)}if("fast_view"==name&&$(".smart-filter-filter").length){var navButtons='<div class="navigation-wrapper-fast-view"><div class="fast-view-nav prev bg-theme-hover" data-fast-nav="prev"><i class="svg left"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="6.969" viewBox="0 0 12 6.969"><path id="Rounded_Rectangle_702_copy_24" data-name="Rounded Rectangle 702 copy 24" class="cls-1" d="M361.691,401.707a1,1,0,0,1-1.414,0L356,397.416l-4.306,4.291a1,1,0,0,1-1.414,0,0.991,0.991,0,0,1,0-1.406l5.016-5a1.006,1.006,0,0,1,1.415,0l4.984,5A0.989,0.989,0,0,1,361.691,401.707Z" transform="translate(-350 -395.031)"/></svg></i></div><div class="fast-view-nav next bg-theme-hover" data-fast-nav="next"><i class="svg right"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="6.969" viewBox="0 0 12 6.969"><path id="Rounded_Rectangle_702_copy_24" data-name="Rounded Rectangle 702 copy 24" class="cls-1" d="M361.691,401.707a1,1,0,0,1-1.414,0L356,397.416l-4.306,4.291a1,1,0,0,1-1.414,0,0.991,0.991,0,0,1,0-1.406l5.016-5a1.006,1.006,0,0,1,1.415,0l4.984,5A0.989,0.989,0,0,1,361.691,401.707Z" transform="translate(-350 -395.031)"/></svg></i></div></div>';hash.w.closest("#popup_iframe_wrapper").append(navButtons)}var needScrollbar=!0;"Y"==arAsproOptions.THEME.REGIONALITY_SEARCH_ROW&&(hash.w.hasClass("city_chooser_frame")||hash.w.hasClass("city_chooser_small_frame"))&&(hash.w.addClass("small_popup_regions"),hash.w.addClass("jqmWindow--overflow-visible"),needScrollbar=!1),hash.w.addClass("show").css({opacity:1}),needScrollbar&&hash.w.find(">div").addClass("scrollbar")},appAspro.popup.onHidejqm=(name,hash)=>{$(hash.w).data("autohide")&&eval($(hash.w).data("autohide")),hash.w.animate({opacity:0},200,(function(){var navButtons;(hash.w.hide(),hash.w.empty(),hash.o.remove(),hash.w.removeClass("show"),hash.w.removeClass("success"),$("body").css({overflow:"",height:"","padding-right":""}),hash.w.closest("#popup_iframe_wrapper").find(".jqmOverlay").length||hash.w.closest("#popup_iframe_wrapper").css({"z-index":"",display:""}),window.matchMedia("(max-width: 991px)").matches&&$("body").removeClass("all_viewed"),$(".jqmOverlay:not(.mobp)").length&&!$(".jqmOverlay.waiting").length||$("body").removeClass("jqm-initied"),$("body").removeClass("swipeignore"),$("body").removeClass("overflow-block"),"fast_view"==name)&&($(".fast_view_popup").remove(),hash.w.closest("#popup_iframe_wrapper").find(".navigation-wrapper-fast-view").remove());"ocb"==name&&hash.w.removeClass("compact"),"stores"==name&&(window.GLOBAL_arMapObjects={})})),window.b24form=!1},$.fn.jqmEx=function(onLoad,onHide){$(this).each((function(){let $this=$(this),name=$this.data("name");name=void 0!==name&&name.length?name:"noname";let paramsStr="",trigger=$this;if($.each($this.get(0).attributes,(function(index,attr){var attrName=attr.nodeName,attrValue=$this.attr(attrName);if(/^data\-param\-(.+)$/.test(attrName)){var key=attrName.match(/^data\-param\-(.+)$/)[1];paramsStr+=key+"="+attrValue+"&"}})),"ocb"==name&&arAsproOptions.MODULES.sale){let $buyAction=$this.closest(".buy_block").find('.js-item-action[data-action="basket"]');if($buyAction.length){let action=JItemAction.factory($buyAction[0]);if(action.valid){let dataItem=action.data;dataItem&&(paramsStr+="ELEMENT_ID="+dataItem.ID+"&",paramsStr+="IBLOCK_ID="+dataItem.IBLOCK_ID+"&",paramsStr+="ELEMENT_QUANTITY="+action.quantity+"&");let props=action.node.getAttribute("data-props")||"";try{props=props.length?props.split(";"):[]}catch(e){props=[]}paramsStr+="OFFER_PROPS="+JSON.stringify(props)+"&"}}}let script=arAsproOptions.SITE_DIR+"ajax/form.php";script+="auth"==name?"?"+paramsStr+"auth=Y":"?"+paramsStr;let extClass="";$this.closest("#fast_view_item").length&&(extClass="fast_view_popup");var noOverlay="Y"==$this.data("noOverlay");if(void 0===$.fn.jqmEx.counter?$.fn.jqmEx.counter=0:++$.fn.jqmEx.counter,noOverlay)var frame=$('<div class="'+name+"_frame "+extClass+' jqmWindow popup" data-popup="'+$.fn.jqmEx.counter+'"></div>').appendTo("body");else var frame=$('<div class="'+name+"_frame "+extClass+' jqmWindow popup" data-popup="'+$.fn.jqmEx.counter+'"></div>').appendTo("#popup_iframe_wrapper");appAspro.loadScript([arAsproOptions.SITE_TEMPLATE_PATH+"/js/jqModal.js"],()=>{frame.jqm({ajax:script,trigger:trigger,noOverlay:noOverlay,onLoad:function(hash){appAspro.popup.onLoadjqm(name,hash,$this),"function"==typeof onLoad&&onLoad(name,hash,$this)},onHide:function(hash){appAspro.popup.onHidejqm(name,hash,$this),"function"==typeof onHide&&onHide(name,hash,$this)}}),$this.trigger("click")})}))},$(document).on("click",'*[data-event="jqm"]',(function(e){e.preventDefault(),e.stopPropagation(),$(this).hasClass("clicked")||($(this).addClass("clicked"),$(this).jqmEx())}));